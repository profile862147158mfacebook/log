if (self.CavalryLogger) { CavalryLogger.start_js(["GPB5W"]); }

__d('MVerifyCache',['MCache'],(function a(b,c,d,e,f,g,h){var i=function j(k){var l=h.VIEWER_KEY,m=h.getItem(l);if(m!==k.viewer){m&&h.clear();h.setItem(l,k.viewer,true)}};g.main=i}),null);
__d('MPageError',['$','DOM','LoadingIndicator','MErrorCodes','JSLog','MPageController','Stratcom'],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n){var o=h('mErrorView'),p=i.find(o,'div','error-message');n.listen('click','MPageError:retry',m.reload);n.listen('m:page:loading',null,function(q){i.hide(o)});n.listen('m:page:error',null,function(q){var r=q.getData(),s=k.getMessage(r);j.hide();i.setContent(p,s);i.show(o);l.warn('Error code: %s',r)})}),null);
__d('SemKochavaLanding',['goURI'],(function a(b,c,d,e,f,g,h){'use strict';var i={redirectToUrl:function j(k){h(k)}};f.exports=i}),null);
__d('MExceptionConstants',[],(function a(b,c,d,e,f,g){var h={MAX_STACK_LENGTH:3000,MAX_FUNCTION_CODE_LENGTH:1000,MAX_ARGUMENT_VALUE_LENGTH:150,MAX_SCRIPT_URI_LENGTH:500,MAX_SCRIPT_TEXT_LENGTH:3000,MAX_LOG_HISTORY_LENGTH:5000,MAX_SINGLE_ENTRY_LENGTH:300,MANAGED_TAG:'[managed]',NATIVE_TAG:'[native]',SOURCE_TAG:'[source]',JSON_TAG:'[json]',PROPERTIES_TAG:'[properties]',FAILURE_TAG:'[failure]'};f.exports=h}),null);
__d('MExceptionHandler',['ex','ErrorUtils','JSLog'],(function a(b,c,d,e,f,g,h,i,j){if(window.onerror!==i.onerror)j.error('ErrorUtils failed to assign window.onerror handler');function k(l,m){i.reportError(new Error(h('fwHandleException: %s, context: %s',l,m)))}b.fwHandleException=k}),null);
__d('MExceptionUtilities',['MExceptionConstants'],(function a(b,c,d,e,f,g,h){var i={argsToString:function j(k){var l=[];for(var m=0;m<k.length;m++)l.push(i.initAndTail(String(k[m]),h.MAX_ARGUMENT_VALUE_LENGTH));return '['+l.join(', ')+']'},initAndTail:function j(k,l){if(k.length<=l)return k;return k.slice(0,Math.ceil(l/2-1.5))+'...'+k.slice(k.length-Math.floor(l/2-1.5))},initAndTailArray:function j(k,l){var m=[],n=[],o=m,p=0,q=k.length-1,r=0,s=0,t=0,u=0;while(p<=q&&u<l)if(s<=t){m.push(k[p]);s+=k[p].length;u+=k[p].length;o=m;r=m.length-1;p++}else{n.unshift(k[q]);t+=k[q].length;u+=k[q].length;o=n;r=0;q--}if(!(u<=l&&p>q)&&o.length>0){var v=Math.min(l-u+o[r].length,3);o[r]=new Array(v+1).join('.')}return m.concat(n)},tail:function j(k,l){if(k.length<=l)return k;return '...'+k.substr(k.length-l+3)},tailArray:function j(k,l){var m=[],n=k.length-1,o=0;while(n>=0&&o<l){m.unshift(k[n]);o+=k[n].length;n--}if(!(o<=l&&n<0)&&m.length>0){var p=Math.min(l-o+m[0].length,3);m[0]=new Array(p+1).join('.')}return m}};f.exports=i}),null);
__d('MLogger',['CurrentUser','ErrorUtils','JSErrorExtra','JSErrorPlatformColumns','LogHistory','MExceptionConstants','MExceptionUtilities','SiteData','MRequest','ScriptPath','idx','setTimeoutAcrossTransitions'],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t='This error is used for stack trace capturing only',u=Date.now(),v={_LOG_PAGE:'/a/logs',_MAX_QUEUE_SIZE:100,_DEFAULT_SUB_TYPE:'m_js_err',_messageQueue:[],_flushLogs:function w(){if(v._messageQueue.length===0)return;if(!window.FB_GKS.mobile_js_show_debug&&true&&!window.FB_GKS.mobile_js_log_error)return;new p(v._LOG_PAGE).setData({message:JSON.stringify({data:v._messageQueue})}).setIgnoreErrors(true).send();v._messageQueue.length=0},_log:function w(x,y,z,aa){if(v._messageQueue.length===0)s(v._flushLogs,1000);if(v._messageQueue.length<v._MAX_QUEUE_SIZE){var ba,ca=window.location,da=ca.hash,ea=da.indexOf('/'),fa=ea>-1?da.substr(ea):ca.pathname+ca.search;aa=i.normalizeError(aa);var ga;if(typeof aa.stack==='string'&&Array.isArray(aa.stackFrames)){ga=n.initAndTailArray(aa.stack.split('\n'),m.MAX_STACK_LENGTH);ga=aa.stackFrames.slice(0,ga.length);ga=ga.map(function(ja){var ka={};Object.assign(ka,ja);delete ka.text;return ka})}var ha,ia=p.getContextualInstance();if(ia&&!ia.getCORS())ha=ia.getTransport().getResponseHeader('X-FB-Debug');v._messageQueue.push({log_type:'reliability',sub_type:y,time:Date.now(),path:fa,uid:h.getID(),features:{managed_stack_trace:!!window.__STACK__,cross_origin_inline:!!window.__CORS_XHR__},log_history:v._getLogHistoryEntries(),msg:{type:x,args:z,stack:ga,name:aa.name,revision:o.client_revision,push_phase:o.push_phase,script:aa.script,line:aa.line,column:aa.column,guards:aa.guardList,page_age:Date.now()-u,extra:v._getExtraTags(aa),app_id:k.app_id,x_fb_debug:ha,script_path:(ba=q.getPageInfo())!=null?ba.scriptPath:ba}})}},_getLogHistoryEntries:function w(){if(!b.FB_GKS.m_js_log_history)return;var x=l.getEntries().map(function(y){return n.initAndTail('['+y.date+'] ('+y.level+') '+y.category+': '+y.event+' '+n.initAndTail(y.args,m.MAX_ARGUMENT_VALUE_LENGTH),m.MAX_SINGLE_ENTRY_LENGTH)});return n.tailArray(x,m.MAX_LOG_HISTORY_LENGTH)},_getExtraTags:function w(x){var y=x.extra||{},z={};Object.keys(j).forEach(function(aa){if(j[aa])z[aa]=true;});Object.keys(y).forEach(function(aa){if(y[aa]){z[aa]=true}else if(z[aa])delete z[aa];});return Object.keys(z)},error:function w(x,y){for(var z=arguments.length,aa=Array(z>2?z-2:0),ba=2;ba<z;ba++)aa[ba-2]=arguments[ba];v._log(x.type||'mustfix',v._DEFAULT_SUB_TYPE,[y].concat(aa),x)}};i.addListener(function(w){var x;if(w.messageWithParams){x=w.messageWithParams;v.error.apply(v,[w].concat(x))}else if(w.messageObject){if(w.message==='[object Event]'){var event=w.messageObject,y=event.target||event.srcElement;if(y!==event.currentTarget){x=['Event "%s" bubbling from "%s" reaching "%s"',event.type,String(y),String(event.currentTarget)]}else if(y&&y.nodeName==='SCRIPT'){x=['Event "%s" from script element with src "%s", handler: %s',event.type,y.getAttribute('src'),String(y['on'+event.type])]}else x=['Unknown event "%s" from element "%s"',event.type,y.nodeName];v.error.apply(v,[w].concat(x))}else v.error(w,w.message);}else v.error(w,w.message);});f.exports=v}),null);
__d('DeviceBasedLoginRedesignChooserUser',['EventListener','Keys'],(function a(b,c,d,e,f,g,h,i){var j={attachHandlerToElement:function k(l,m){h.listen(l,'click',function(){m.submit()});h.listen(l,'keyup',function(n){if(n.keyCode===i.RETURN)m.submit();})}};f.exports=j}),null);
__d('MExceptionReportingMarauderLogger',['ErrorUtils'],(function a(b,c,d,e,f,g,h){function i(k){e(['MarauderLogger'],function(l){l.log('js_exception',undefined,k);k=null})}function j(k,l,m){i({message:k,context:l,stack_trace:m})}h.addListener(function(k){i(k)});f.exports.log=j}),null);
__d('MPopupSmallCta',['MAnimator','Style','MViewport','ge'],(function a(b,c,d,e,f,g,h,i,j,k){var l=150,m=1000,n=214,o={show:function p(q,r,s){this._expandingCta=q;this._ctaUnit=r;this._closeIcon=s;this._ctaVisible=false;this._ctaShownOnce=false;this._ctaClosed=false;window.addEventListener('load',this._init.bind(this))},_init:function p(){var q=k('header'),r=k('header-notices'),s=k('mobile_login_bar');this._scrollThreshold=0;this._height=n;if(q){i.set(q,'z-index','0');var t=q.clientHeight;if(t)this._scrollThreshold+=t;}if(r){i.set(r,'z-index','0');var u=r.clientHeight;if(u)this._scrollThreshold+=u;}if(s){var v=s.clientHeight;if(v){this._scrollThreshold+=v;this._height=v}}setInterval(this._updateCTA.bind(this),m);this._closeIcon.addEventListener('click',function(w){this._ctaClosed=true;this._hideCTA()}.bind(this))},_hideCTA:function p(){var q=this._expandingCta.clientHeight;h.play(q,0,l,function(r){return i.set(this._expandingCta,'height',Math.round(r)+'px')}.bind(this));this._ctaVisible=false;clearTimeout(this._timerId)},_showCTA:function p(){if(this._ctaVisible)return;i.set(this._ctaUnit,'margin-top','0px');i.set(this._expandingCta,'background','none');h.play(0,this._height,l,function(q){return i.set(this._expandingCta,'height',Math.round(q)+'px')}.bind(this));this._ctaVisible=true;this._ctaShownOnce=true;clearTimeout(this._timerId)},_updateCTA:function p(){var q=j.getHeight();if(q<this._height)if(this._ctaVisible){this._hideCTA()}else return;var r=this._scrollThreshold;if(!this._ctaVisible&&!this._ctaClosed&&j.getScrollTop()>r)this._showCTA();if(this._ctaVisible&&j.getScrollTop()<r)this._hideCTA();}};f.exports=o}),null);
__d('TimeSpentArray',['Banzai','pageID','setTimeoutAcrossTransitions'],(function a(b,c,d,e,f,g,h,i,j){var k=2,l=k*32,m,n,o,p,q,r,s,t,u,v={},w;function x(){return {timeoutDelayMap:v,nextDelay:w,timeoutInSeconds:o}}function y(){if(m){var ga=Date.now();if(ga>q)s=Math.min(l,Math.ceil(ga/1000-p));var ha=da();if(ha)m(ha,w);}ca()}function z(){aa();n=j(y,o*1000)}function aa(){if(n){clearTimeout(n);n=null}}function ba(ga){p=ga;q=p*1000;r=[1];for(var ha=1;ha<k;ha++)r.push(0);s=1;t+=1;u+=1;var ia=u.toString()+'_delay';w=v[ia];if(w===undefined)w=v.delay;var ja=u.toString()+'_timeout',ka=v[ja];if(ka===undefined)ka=v.timeout;ka=Math.min(ka,l);o=ka||l;z()}function ca(){aa();r=null}function da(){if(!r)return null;return {tos_id:i,start_time:p,tos_array:r.slice(0),tos_len:s,tos_seq:u,tos_cum:t}}function ea(ga){if(ga>=q&&ga-q<1000)return;fa(Math.floor(ga/1000))}function fa(ga){var ha=ga-p;if(ha<0||ha>=l)y();if(!r){ba(ga)}else{r[ha>>5]|=1<<(ha&31);s=ha+1;t+=1;q=ga*1000}}f.exports={init:function ga(ha,ia,ja){t=0;u=-1;m=ha;if(typeof ia=='object'&&ia!==null){v=ia}else v={};if(!ja)ja=Date.now();ba(Math.floor(ja/1000));h.subscribe(h.SHUTDOWN,y)},update:function ga(ha){ea(ha)},get:function ga(){return da()},ship:function ga(){y()},reset:function ga(){ca()},testState:function ga(){return x()}}}),null);
__d('TimeSpentImmediateActiveSecondsLogger',['Banzai','ImmediateActiveSecondsConfig','ScriptPath'],(function a(b,c,d,e,f,g,h,i,j){var k='immediate_active_seconds',l={signal:true,retry:true},m=i.sampling_rate,n=i.ias_bucket,o=0;function p(r){if(m<=0)return false;var s=Math.floor(r/1000)%m;return s===n}function q(r){if(r>=o&&r-o<1000)return;if(p(r)){var s={activity_time_ms:r,last_activity_time_ms:o,script_path:j.getTopViewEndpoint()};try{h.post(k,s,l)}catch(t){}}o=Math.floor(r/1000)*1000}f.exports={maybeReportActiveSecond:q}}),null);
__d('MTimeSpentBitArrayLogger',['Banzai','BanzaiODS','Stratcom','MarauderLogger','TimeSpentArray','TimeSpentImmediateActiveSecondsLogger','Visibility','isInIframe'],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){l.ship()}function q(){var u=Date.now();l.update(u);m.maybeReportActiveSecond(u)}function r(u){k.log('time_spent_bit_array',undefined,u,undefined,undefined,undefined,Date.now())}function s(){return ['gesturestart','mousedown','touchstart','scroll','keydown']}function t(){var u=s();j.listen(u,null,q);var v='onpagehide' in window?['pagehide','blur']:['blur'];j.listen(v,null,p);n.addListener('hidden',p)}f.exports={init:function u(v){if(o())return;var w=Date.now();l.init(r,null,w);t();m.maybeReportActiveSecond(w);i.bumpEntityKey('ms.time_spent.qa.'+v,'time_spent.bits.js_initialized')},getMonitoredEvents:s}}),null);
__d('MBackButton',['Stratcom'],(function a(b,c,d,e,f,g,h){var i=false,j=function k(){if(i)return;i=true;h.listen('click','back-button',function(event){if(history.length>1){event.prevent();history.go(-1)}})};g.main=j}),null);
__d('MModalDialogInit',['MModalDialog'],(function a(b,c,d,e,f,g,h){if(!b.FW_ENABLED)h.init();}),null);
__d("XConsentCookieController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/cookie\/consent\/",{})}),null);
__d('DeferredCookie',['Cookie','Env','Map','SubscriptionList','XAsyncRequest','XConsentCookieController'],(function a(b,c,d,e,f,g,h,i,j,k,l,m){'use strict';var n=new j(),o={shouldAddDefaultListener:true,defaultHandler:null,autoFlushCookies:false,sentConsentToServer:false,callbacks:new k(),addToQueue:function p(q,r,s,t,u,v,w){if(this.autoFlushCookies){if(u){h.setWithoutChecksIfFirstPartyContext(q,r,s,t,w)}else h.setWithoutChecks(q,r,s,t,w);return}if(n.has(q))return;n.set(q,{name:q,value:r,nMilliSecs:s,path:t,firstPartyOnly:u,secure:w});if(v)this.addDefaultInteractionListener();},flushAllCookiesWithoutRequestingConsentSeePrivacyXFNBeforeUsing:function p(){delete i.defer_cookies;n.forEach(function(q,r){if(q.firstPartyOnly){h.setWithoutChecksIfFirstPartyContext(q.name,q.value,q.nMilliSecs,q.path,q.secure)}else h.setWithoutChecks(q.name,q.value,q.nMilliSecs,q.path,q.secure);});this.callbacks.fireCallbacks();this.autoFlushCookies=true;n=new j();this.removeDefaultInteractionListener()},flushAllCookies:function p(){this.flushAllCookiesWithoutRequestingConsentSeePrivacyXFNBeforeUsing();if(!this.sentConsentToServer){this.sentConsentToServer=true;var q=m.getURIBuilder().getURI();new l(q).send()}},removeDefaultInteractionListener:function p(){if(this.defaultHandler){if(window.removeEventListener){window.removeEventListener('click',this.defaultHandler,true)}else if(document.detachEvent)document.detachEvent('onclick',this.defaultHandler);this.defaultHandler=null}},addDefaultInteractionListener:function p(){if(this.shouldAddDefaultListener){this.shouldAddDefaultListener=false;this.defaultHandler=this.baseInteractionHandler.bind(this);if(window.addEventListener){window.addEventListener('click',this.defaultHandler,true)}else if(document.attachEvent)document.attachEvent('onclick',this.defaultHandler);}},registerCallbackOnCookieFlush:function p(q){if(this.autoFlushCookies){q()}else this.callbacks.add(q);},baseInteractionHandler:function p(){this.flushAllCookies()},canEmbedThirdPartyPixel:function p(){if(i.no_cookies||i.defer_cookies)return false;return this.autoFlushCookies||n.size===0}};f.exports=o}),null);
__d("NavigationMetricsEnumJS",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({NAVIGATION_START:"navigationStart",UNLOAD_EVENT_START:"unloadEventStart",UNLOAD_EVENT_END:"unloadEventEnd",REDIRECT_START:"redirectStart",REDIRECT_END:"redirectEnd",FETCH_START:"fetchStart",DOMAIN_LOOKUP_START:"domainLookupStart",DOMAIN_LOOKUP_END:"domainLookupEnd",CONNECT_START:"connectStart",CONNECT_END:"connectEnd",SECURE_CONNECTION_START:"secureConnectionStart",REQUEST_START:"requestStart",RESPONSE_START:"responseStart",RESPONSE_END:"responseEnd",DOM_LOADING:"domLoading",DOM_INTERACTIVE:"domInteractive",DOM_CONTENT_LOADED_EVENT_START:"domContentLoadedEventStart",DOM_CONTENT_LOADED_EVENT_END:"domContentLoadedEventEnd",DOM_COMPLETE:"domComplete",LOAD_EVENT_START:"loadEventStart",LOAD_EVENT_END:"loadEventEnd"})}),null);
__d('LogHistoryListeners',['Clock','ErrorUtils','LogHistory'],(function a(b,c,d,e,f,g,h,i){var j=c('LogHistory').getInstance('sys');h.addListener(h.ANOMALY,function(k){j.warn('clock_anomaly',h.getSamples())});i.addListener(function(k){j.error('error',JSON.stringify({guard:k.guard,line:k.line,message:k.message,script:k.script,stack:k.stack}))})}),null);
__d('ScriptPathLogger',['Banzai','CurrentUser','ScriptPath','TimeSpentPageTransitionCause','URI','isInIframe'],(function a(b,c,d,e,f,g,h,i,j,k,l,m){'use strict';var n='script_path_change',o={scriptPath:null,categoryToken:null,extraData:{}},p=false,q='imp_id';function r(ba){var ca=l.getNextURI?l.getNextURI():new l(window.location.href),da=ca.getQueryData(),ea=ca.getPath();if(ea.endsWith('/'))ea=ea.substr(0,ea.length-1);var fa=s(ea,da);if(fa){ba.content_id=fa;return}var ga=t(ea);if(ga!==''){ba.dest_topic_feed=ga;return}if(u(ea)){var ha=da.queue_id;if(ha)ba.dest_srt_queue_id=ha;return}}function s(ba,ca){if(ca.story_fbid)return ca.story_fbid;if(ca.fbid)return ca.fbid;if(ca.view==='permalink'&&ca.id)return ca.id;var da=/\/(posts|videos|notes|groups\/.*\/permalink)\//,ea=/^[0-9]+$/;if(da.test(ba)){var fa=ba.split('/'),ga=fa[fa.length-1];if(ea.test(ga))return ga;}return ''}function t(ba){if(!ba||ba.search('/feed/topics/')==-1)return '';var ca=ba.split('/');return ca[ca.length-1]}function u(ba){return !!ba&&ba.search('/intern/review/')!==-1}function v(ba,ca,da,ea){if(!p||m())return;var fa=i.isLoggedIn(),ga=fa?h.VITAL:h.BASIC;if(fa){ea=ea||{};ea.via_banzai_vital='1'}var ha={source_path:ba.scriptPath,source_token:ba.categoryToken,dest_path:ca.scriptPath,dest_token:ca.categoryToken,impression_id:ca.extraData?ca.extraData.imp_id:null,cause:da},ia=da===k.PAGE_UNLOAD;if(!ia)r(ha);if(ea!=null){var ja=ea,ka=ja.snowlift_content_id;if(!ia&&ka!=null){ha.content_id=ka;delete ea.snowlift_content_id}ha.extra_data=ea}if(ba.scriptPath===null)ha.referrer=document.referrer;var la=j.getClickPointInfo();if(la)ha.click_point_info=la;if(ba.extraData)for(var ma in ba.extraData)if(ma!=q)ha['source_'+ma]=ba.extraData[ma];if(ca.extraData)for(var na in ca.extraData)if(na!=q)ha['dest_'+na]=ca.extraData[na];if(ba.topViewEndpoint)ha.source_endpoint=ba.topViewEndpoint;if(ca.topViewEndpoint)ha.dest_endpoint=ca.topViewEndpoint;if(ba.restored)ha.source_restored=true;h.post(n,ha,ga);j.setClickPointInfo(null)}function w(){v(j.getSourcePageInfo()||o,j.getPageInfo()||o,k.PAGE_LOAD)}function x(ba,ca,da){v(ba,ca,k.TRANSITION,da)}function y(){v(j.getPageInfo()||o,o,k.PAGE_UNLOAD);j.shutdown()}var z=j.subscribe(function(ba){if(p){var ca=ba.source,da=ba.dest,ea=ba.cause,fa=ba.extraData;if(ea){v(ca||o,da||o,ea,fa)}else if(ca){x(ca,da||o,fa)}else w();}});h.subscribe(h.SHUTDOWN,y);var aa={startLogging:function ba(){p=true;if(j.getPageInfo())w();},stopLogging:function ba(){p=false;z.remove()},BANZAI_LOGGING_ROUTE:n};f.exports=aa}),null);
__d('NavigationTimingHelper',['NavigationMetricsEnumJS','forEachObject','performance'],(function a(b,c,d,e,f,g,h,i,j){function k(m,n){var o={};i(h,function(p){var q=n[p];if(q)o[p]=q+m;});return o}var l={getAsyncRequestTimings:function m(n){if(!n||!j.timing||!j.getEntriesByName)return undefined;var o=j.getEntriesByName(n);if(o.length===0)return undefined;return k(j.timing.navigationStart,o[0])},getNavTimings:function m(){if(!j.timing)return undefined;return k(0,j.timing)}};f.exports=l}),null);
__d('PerfXFlusher',['Banzai','invariant'],(function a(b,c,d,e,f,g,h,i){var j='perfx_custom_logger_endpoint',k=['perfx_page','perfx_page_type','lid'];function l(n){k.forEach(function(o){return i(o in n,'PerfXFlusher: Field "%s" missing in the PerfX payload',o)})}var m={flush:function n(o){l(o);h.post(j,o,{signal:true})},registerToSendWithBeacon:function n(o){h.registerToSendWithBeacon(j,o)}};f.exports=m}),null);
__d("pageLoadedViaSWCache",[],(function a(b,c,d,e,f,g){function h(){return self.__SW_CACHE__===1}f.exports=h}),null);
__d('PerfXLogger',['DataAttributeUtils','NavigationMetrics','NavigationTimingHelper','PerfXFlusher','Set','forEachObject','pageLoadedViaSWCache','performanceAbsoluteNow','setTimeoutAcrossTransitions'],(function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q={},r={},s=65*1000,t=['e2e','tti','all_pagelets_displayed','all_pagelets_loaded'],u={},v={_listenersSetUp:false,_setupListeners:function w(){if(this._listenersSetUp)return;this._subscribeToNavigationMetrics();k.registerToSendWithBeacon(function(){var x=[];m(q,function(y,z){if(!q[z].sent){var aa=this.getPayload(z,'unload fired');if(aa!=null)x.push(aa);}}.bind(this));q={};return x}.bind(this));this._listenersSetUp=true},_init:function w(x){var y=x.lid;if(y==null)return;var z=r[y]||[];delete r[y];if(x.sw_controlled_tags){if(navigator.serviceWorker&&navigator.serviceWorker.controller)for(var aa=0;aa<x.sw_controlled_tags.length;aa++)z.push(x.sw_controlled_tags[aa]);delete x.sw_controlled_tags}q[y]=babelHelpers['extends']({tags:new l(z),sent:false},x);this._registerTimeoutSendback(y);this._setupListeners()},initWithNavigationMetricsLID:function w(x,y){var z=i.getFullPageLoadLid();if(!z)return;this._init(babelHelpers['extends']({},y,{lid:z}));if(x&&x.always)for(var aa=0;aa<x.always.length;aa++)v.addTag(z,x.always[aa]);if(x&&x.swCache&&n())for(var ba=0;ba<x.swCache.length;ba++)v.addTag(z,x.swCache[ba]);},init:function w(x,y){if(y!=null&&x.lid!=null)u[x.lid]=y;this._init(x)},addTag:function w(x,y){var z=q[x];if(z){z.tags.add(y);return}if(!r[x])r[x]=[];r[x].push(y)},addTagWithNavigationMetricsLID:function w(x){var y=i.getFullPageLoadLid();if(!y)return;v.addTag(y,x)},_registerTimeoutSendback:function w(x){var y=this._getFetchStart(x),z=s;if(y!=null)z-=o()-y;p(function(){return this._uploadPayload(x,'sendback time out')}.bind(this),z)},_subscribeToNavigationMetrics:function w(){i.addRetroactiveListener(i.Events.EVENT_OCCURRED,function(x,y){if(!(x in q))return;if(t.includes(y.event)&&Object.prototype.hasOwnProperty.call(y,'timestamp')&&y.timestamp!=null){q[x][y.event]=y.timestamp;if(y.visibilityState)q[x][y.event+'_page_visibility']=y.visibilityState;}});i.addRetroactiveListener(i.Events.NAVIGATION_DONE,function(x,y){var z=y.serverLID;if(!(z in q))return;t.forEach(function(event){if(Object.prototype.hasOwnProperty.call(y,event)&&y[event]!=null)q[z][event]=y[event];});this._uploadPayload(z)}.bind(this))},_getPayloadWithOffset:function w(x,y,z){var aa=q[x];if(aa==null)return null;var ba=Object.assign({},aa),ca=document.querySelector('[id^="hyperfeed_story_id"]');if(ca){var da=JSON.parse(h.getDataFt(ca));if(da)ba.mf_query_id=da.qid;}ba.tags=Array.from(aa.tags);this._adjustValues(ba,y);ba.fetch_start=y;if(ba.perfx_page_type==='normal'){var ea=j.getNavTimings();if(ea!=null&&ea.navigationStart!=null)ba.nav_to_fetch=y-ea.navigationStart;}if(z!=null)ba.sendback_reason=z;if(navigator&&navigator.hardwareConcurrency)ba.num_cores=navigator.hardwareConcurrency;if(navigator&&navigator.deviceMemory)ba.ram_gb=navigator.deviceMemory;if(navigator&&navigator.connection){if(typeof navigator.connection.downlink==='number')ba.downlink_megabits=navigator.connection.downlink;if(typeof navigator.connection.effectiveType==='string')ba.effective_connection_type=navigator.connection.effectiveType;if(typeof navigator.connection.rtt==='number')ba.rtt_ms=navigator.connection.rtt;}delete ba.sent;return ba},_uploadPayload:function w(x,y){if(q[x]!=null&&!q[x].sent){var z=this.getPayload(x,y);if(z!=null){k.flush(z);q[x].sent=true}}},getPayload:function w(x,y){return this._getPayloadWithOffset(x,this._getFetchStart(x),y)},_getFetchStart:function w(x){if(!(x in q))return null;var y=void 0,z=q[x].perfx_page_type;if(z=='quickling'){if(!(x in u)){return null}else y=j.getAsyncRequestTimings(u[x]);}else y=j.getNavTimings();if(!y||!y.fetchStart)return null;return y.fetchStart},_adjustValues:function w(x,y){t.forEach(function(z){if(Object.prototype.hasOwnProperty.call(x,z))x[z]-=y;})}};f.exports=v}),null);