if (self.CavalryLogger) { CavalryLogger.start_js(["ioC7L"]); }

__d('MHideOutsideViewportManager',['BinarySearch','CSS','MLegacyDataStore','DOM','Stratcom','setTimeoutAcrossTransitions'],(function a(b,c,d,e,f,g,h,i,j,k,l,m){function n(){'use strict';this.resetElements();this._arrToVisible=[];this._arrToHidden=[]}n.prototype.dispose=function(){'use strict';this.clearElementsToDraw();this._arrToHidden=[];this._elements=null};n.prototype.resetElements=function(){'use strict';this._elements=k.scry(document.body,'div',n.SIGIL);this._elements=this._elements.filter(function(p){return p.getBoundingClientRect().height>0});this._elements.sort(function(p,q){return p.getBoundingClientRect().top-q.getBoundingClientRect().top});if(!this.hasReachedThreshold())for(var o=0;o<this._elements.length;o++)this._toggleParentUnit(this._elements[o],false);};n.prototype.clearElementsToDraw=function(){'use strict';this._arrToVisible=[];clearTimeout(this._drawTimer);this._drawTimer=null};n.prototype.hasReachedThreshold=function(){'use strict';return this._elements.length>=n.THRESHOLD};n.prototype._isElementInViewport=function(o){'use strict';var p=o.getBoundingClientRect();if(p.top>window.innerHeight+n.BUFFER*1.5)return 1;if(p.bottom<-n.BUFFER*.5)return -1;return 0};n.prototype._toggleSiblingVisibility=function(o,p,q){'use strict';var r=true;for(var s=o;s!==q;s+=p){var t=this._elements[s],u=j.get(t),v=u.hiddenArea,w=u.alwaysShow;if(r&&this._isElementInViewport(t)===0||w){if(v||v===undefined)this._arrToVisible.push(t);}else{r=false;if(!v)this._arrToHidden.push(t);}}};n.prototype._getDistance=function(o,p){'use strict';var q=p.getBoundingClientRect();return Math.abs(o-(q.top+q.height/2))};n.prototype._sortClosestElement=function(o,p){'use strict';return o.distance-p.distance};n.prototype.showElementsInViewport=function(){var o,p=this;'use strict';var q=h.findIndex(function(s){return this._isElementInViewport(this._elements[s])}.bind(this),0,0,this._elements.length);this._arrToVisible=[];this._arrToHidden=[];if(q>-1){this._arrToVisible.push(this._elements[q]);this._toggleSiblingVisibility(q-1,-1,-1);this._toggleSiblingVisibility(q+1,1,this._elements.length)}else this._toggleSiblingVisibility(0,1,this._elements.length);if(this._arrToVisible)(function(){var s=window.innerHeight/2,t=p._arrToVisible.map(function(u){return {element:u,distance:this._getDistance(s,u)}},p);t=t.sort(p._sortClosestElement);p._arrToVisible=t.map(function(u){return u.element})})();var r=[];this._arrToHidden.forEach(function(s){r.push(s.getBoundingClientRect())});this._arrToHidden.forEach(function(s,t){this._makeHidden(s,r[t])},this);this._drawTimer=m(this._makeElementsVisible.bind(this),n.DRAW_TIMER_DELAY)};n.prototype._makeElementsVisible=function(){'use strict';clearTimeout(this._drawTimer);if(this._arrToVisible.length){this._makeVisible(this._arrToVisible.shift());this._drawTimer=m(this._makeElementsVisible.bind(this),n.DRAW_TIMER_DELAY)}};n.prototype._toggleParentUnit=function(o,p){'use strict';var q=this._findParentUnit(o);if(q){i.conditionClass(q,'hideoutOutside',p);if(!n.disableAcceleration)i.conditionClass(q,'accelerate',!p);}};n.prototype._makeVisible=function(o){'use strict';var p=o.style,q=o.children;this._toggleParentUnit(o,false);for(var r=0,s=q.length;r<s;r++)q[r].style.display='';p.height='';p.width='';j.get(o).hiddenArea=false;l.invoke('m:hideout:reflow')};n.prototype._findParentUnit=function(o){'use strict';while(o&&(' '+o.className+' ').indexOf(' accelerateContainer ')===-1)o=o.parentNode;return o};n.prototype._makeHidden=function(o,p){'use strict';var q=o.style;j.get(o).hiddenArea=true;var r=void 0,s=void 0,t=void 0,u=void 0;q.height=p.height+'px';q.width=p.width+'px';var v=o.children;for(var w=0,x=v.length;w<x;w++)v[w].style.display='none';this._toggleParentUnit(o,true)};n.setOptions=function(o){'use strict';var p=n;p.BUFFER=o.buffer||p.BUFFER;p.THRESHOLD=o.threshold||p.THRESHOLD;p.disableAcceleration=o.disable_acceleration};Object.assign(n,{DRAW_TIMER_DELAY:0,BUFFER:6000,THRESHOLD:90,DEBUG_SCROLL:true,SIGIL:'m-hide-outside',disableAcceleration:false});Object.assign(n.prototype,{_elements:null,_arrToVisible:null,_arrToHidden:null,_drawTimer:null});f.exports=n}),null);
__d('MTimelineHideOutsideViewportManager',['setTimeoutAcrossTransitions','MHideOutsideViewportManager','MStopNGo','Stratcom'],(function a(b,c,d,e,f,g,h,i,j,k){var l=void 0,m=function n(o){if(l){k.invoke('m-hide-outside-viewport:update-items');return}l=true;if(!document.body.getBoundingClientRect)return;i.setOptions(o);var p=200,q=void 0,r=void 0,s=[],t=new i(),u=false,v=function fa(){if(u||!t)return;t.resetElements();x();ba()},w=t.showElementsInViewport.bind(t),x=function fa(ga){if(!t.hasReachedThreshold())return;clearTimeout(q);t.clearElementsToDraw();q=h(w,p)},y=function fa(ga){clearTimeout(q);if(!t.hasReachedThreshold())return;t.clearElementsToDraw()},z=function fa(){if(!l)return;while(s.length)s.pop().remove();u=false;clearTimeout(q);clearTimeout(r);s=null;aa=null;t.dispose();t=null;l=false},aa=void 0,ba=function fa(){if(!t.hasReachedThreshold()||aa)return;aa=true;s.push(j.listen('stop',y),j.listen('go',x))};function ca(){r=h(v,0)}function da(){u=true;t.clearElementsToDraw()}function ea(){u=false;v()}ca();s.push(k.listen('m:page:unload',null,z),k.listen(['m-timeline-section-loader:onshow','m-timeline-two-column-layout:rebalance-complete','m-hide-outside-viewport:update-items','m:schedulable:loaded'],null,ca),k.listen('m-timeline-hide-outside:resume',null,ea),k.listen('m-timeline-hide-outside:hold',null,da))};g.main=m}),null);
__d('MTimelineLandscapeCoverCrop',['setTimeoutAcrossTransitions','DOM','Stratcom','MViewport'],(function a(b,c,d,e,f,g,h,i,j,k){var l=void 0,m=function n(o){if(l)return;l=true;function p(){var q=k.isLandscape(),r=i.scry(document.body,'div','landscapeCoverCrop')[0],s=i.scry(document.body,'*','cover-photo')[0];if(!r||!s)return;if(q){var t=k.getUseableHeight(),u=Math.max(window.innerHeight,window.innerWidth),v=u/o.aspectRatio,w=Math.round(t-o.bottomPadding),x=Math.round((v-w)/2);r.style.height=w+'px';s.style.bottom=x+'px'}else{r.style.height='';s.style.bottom=''}j.invoke('m:landscape-cover-crop:complete')}j.listen('m:orientation-resize:complete',null,function(){h(p,0)});p()};g.main=m}),null);